-- start_ignore
--
-- Greenplum Database database dump
--
SET client_encoding = 'UTF8';
SET standard_conforming_strings = off;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET escape_string_warning = off;
SET default_with_oids = false;
--
-- Name: plpgsql; Type: PROCEDURAL LANGUAGE; Schema: -; Owner: gpadmin
--
CREATE LANGUAGE plpgsql;
SET search_path = public, pg_catalog;
SET default_tablespace = '';
--
-- Name: tsdchar; Type: TABLE; Schema: public; Owner: gpadmin; Tablespace:
--
CREATE TABLE tsdchar (
    rnum integer NOT NULL,
    c1 character(27)
) DISTRIBUTED BY (rnum);
--
-- Name: tversion; Type: TABLE; Schema: public; Owner: gpadmin; Tablespace:
--
CREATE TABLE tversion (
    rnum integer NOT NULL,
    c1 integer,
    cver character(6),
    cnnull integer,
    ccnull character(1)
) DISTRIBUTED BY (rnum);
--
-- Data for Name: tsdchar; Type: TABLE DATA; Schema: public; Owner: gpadmin
--
COPY tsdchar (rnum, c1) FROM stdin;
--
-- Data for Name: tversion; Type: TABLE DATA; Schema: public; Owner: gpadmin
--
COPY tversion (rnum, c1, cver, cnnull, ccnull) FROM stdin;
-- CastCharsToBigint_p1
select 'CastCharsToBigint_p1' test_name_part, case when c = 1 then 1 else 0 end pass_ind from (
select count(distinct c) c from (
select f1,f2, count(*) c  from (
select 0 f1, -1 f2 from tversion union
select 1 f1, 0 f2 from tversion union
select 2 f1, 10 f2 from tversion union
select rnum, cast(c1 as bigint) from tsdchar where rnum in (0,1,2)
) Q
group by
f1,f2
) Q ) P;
    test_name_part    | pass_ind 
----------------------+----------
 CastCharsToBigint_p1 |        1
(1 row)

-- CastCharsToSmallint_p1
select 'CastCharsToSmallint_p1' test_name_part, case when c = 1 then 1 else 0 end pass_ind from (
select count(distinct c) c from (
select f1,f2, count(*) c  from (
select 0 f1, -1 f2 from tversion union
select 1 f1, 0 f2 from tversion union
select 2 f1, 10 f2 from tversion union
select rnum, cast(c1 as smallint) from tsdchar where rnum in (0,1,2)
) Q
group by
f1,f2
) Q ) P;
     test_name_part     | pass_ind 
------------------------+----------
 CastCharsToSmallint_p1 |        1
(1 row)

